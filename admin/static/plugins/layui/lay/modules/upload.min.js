/** layui-v1.0.7 LGPL License By http://www.layui.com */
layui.define("layer",function(q){var b=layui.jquery,e=layui.layer,k=(layui.device(),"layui-upload-enter"),l={icon:2,shift:6},r={file:"\u6587\u4ef6",video:"\u89c6\u9891",audio:"\u97f3\u9891"},n=function(a){this.options=a};n.prototype.init=function(){var a=this,d=a.options,g=b("body"),h=b(d.elem||".layui-upload-file"),e=b('\x3ciframe id\x3d"layui-upload-iframe" class\x3d"layui-upload-iframe" name\x3d"layui-upload-iframe"\x3e\x3c/iframe\x3e');return b("#layui-upload-iframe")[0]||g.append(e),h.each(function(e,c){c=b(c);var f='\x3cform target\x3d"layui-upload-iframe" method\x3d"'+(d.method||"post")+'" key\x3d"set-mine" enctype\x3d"multipart/form-data" action\x3d"'+(d.url||"")+'"\x3e\x3c/form\x3e',p=c.attr("lay-type")||d.type;d.unwrap||(f='\x3cdiv class\x3d"layui-box layui-upload-button"\x3e'+f+'\x3cspan class\x3d"layui-upload-icon"\x3e\x3ci class\x3d"layui-icon"\x3e\x26#xe608;\x3c/i\x3e'+(c.attr("lay-title")||d.title||"\u4e0a\u4f20"+(r[p]||"\u56fe\u7247"))+"\x3c/span\x3e\x3c/div\x3e");f=b(f);d.unwrap||f.on("dragover",function(a){a.preventDefault();b(this).addClass(k)}).on("dragleave",function(){b(this).removeClass(k)}).on("drop",function(){b(this).removeClass(k)});"layui-upload-iframe"===c.parent("form").attr("target")&&(d.unwrap?c.unwrap():(c.parent().next().remove(),c.unwrap().unwrap()));c.wrap(f);c.off("change").on("change",function(){a.action(this,p)})})};n.prototype.action=function(a,d){var g=this.options,h=a.value,k=b(a),m=k.attr("lay-ext")||g.ext||"";if(h){switch(d){case "file":if(m&&!RegExp("\\w\\.("+m+")$","i").test(escape(h)))return e.msg("\u4e0d\u652f\u6301\u8be5\u6587\u4ef6\u683c\u5f0f",l),a.value="";break;case "video":if(!RegExp("\\w\\.("+(m||"avi|mp4|wma|rmvb|rm|flash|3gp|flv")+")$","i").test(escape(h)))return e.msg("\u4e0d\u652f\u6301\u8be5\u89c6\u9891\u683c\u5f0f",l),a.value="";break;case "audio":if(!RegExp("\\w\\.("+(m||"mp3|wav|mid")+")$","i").test(escape(h)))return e.msg("\u4e0d\u652f\u6301\u8be5\u97f3\u9891\u683c\u5f0f",l),a.value="";break;default:if(!RegExp("\\w\\.("+(m||"jpg|png|gif|bmp|jpeg")+")$","i").test(escape(h)))return e.msg("\u4e0d\u652f\u6301\u8be5\u56fe\u7247\u683c\u5f0f",l),a.value=""}g.before&&g.before(a);k.parent().submit();var c=b("#layui-upload-iframe"),f=setInterval(function(){var b;try{b=c.contents().find("body").text()}catch(t){e.msg("\u4e0a\u4f20\u63a5\u53e3\u5b58\u5728\u8de8\u57df",l),clearInterval(f)}if(b){clearInterval(f);c.contents().find("body").html("");try{b=JSON.parse(b)}catch(t){return e.msg("\u8bf7\u5bf9\u4e0a\u4f20\u63a5\u53e3\u8fd4\u56deJSON\u5b57\u7b26",l)}"function"==typeof g.success&&g.success(b,a)}},30);a.value=""}};q("upload",function(a){(new n(a||{})).init()})});